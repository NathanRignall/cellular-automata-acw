\section{Cell Growth}

% Task 2.1

% Simulate the growth of tumour cells for t=1200. Does the growth reach a steady state?
% If it has not, then experiment with the final time and determine the Time required to reach a steady state.

% 10 marks for basic simulation, 5 marks for showing time to reach final time 
% You can also use analytical methods to do the same

% Task 2.2

% Will the rate of growth reach a steady state or will the number increase as you keep increasing the size of the grid?
% What will happen if the value of M is changed - pick two values on either side of the value given.
% The issues associated with the numerical strategy you are employing,

% 5 marks for the part where you suggest what happens when the value of M changes, and why this is important


% Modelling the growth as a differential equation, we have the following equation:

% \[ \frac{dN}{dt}  = kNln\left(\frac{M}{n} \right) \]

% \[ N = \dfrac{M}{10^{4e^{-kt}}}  \]

Using the Euler method, we can simulate the differential equation for cell growth in \autoref{fig:task2-1}.
This uses the rate of growth at a point in time to calculate the number of cells at the next time step.

\begin{figure}[ht]
    \centering
    \includegraphics[width=14cm]{task2-1}
    \caption[Cell growth simulation]{Cell growth simulation}
    \label{fig:task2-1}
\end{figure}

The growth appears to reach a steady state at around 1200 time units, at this time the percentage of cells filled is 99.31\%.
Given the growth is modelled using an exponential function, the growth fills 100\% at $t = \infty$,
this applies if the simulation has an infinite accuracy.
At a certain point, the percentage of cells filled will be 100\% as the value is rounded up.
Steady state can be defined numerically as:

\begin{itemize}
    \item The percentage of cells filled is near 100\%.
    \item The rate of change of cell growth is near 0.
    \item The rate of change of the rate of change of cell growth is near 0.
\end{itemize}

\begin{figure}[ht]
    \centering
    \includegraphics[width=14cm]{task2-1-t-dt}
    \caption[Cell growth simulation (dN/dt)]{Cell growth simulation (dN/dt)}
    \label{fig:task2-1-t-dt}
\end{figure}

% Graph displays both the rate of growth and the percentage of cells filled.

% \begin{figure}[ht]
%     \centering
%     \includegraphics[width=14cm]{task2-1-t}
%     \caption[Cell growth simulation with different T values]{Cell growth simulation with different T values}
%     \label{fig:task2-1-t}
% \end{figure}

% \begin{center}
% \begin{tabular}{c | c c} 
%     T & Cells & \ Full \\
%     \hline
%     2000 & 1.00e+13 & 99.99\% \\
%     1800 & 1.00e+13 & 99.98\% \\
%     1600 & 9.99e+12 & 99.94\% \\
%     1400 & 9.98e+12 & 99.79\% \\
%     1200 & 9.93e+12 & 99.31\% \\
%     1000 & 9.77e+12 & 97.74\% \\    
% \end{tabular}
% \end{center}



% If the growth is modelled at a real value at t = infinity, the percentage of cells is 100\%.
% Anything less than infinity will have a percentage less than 100\%.

% Cannot simulate to infinity, so we have to simulate to a large enough value to reach a steady state.

% Analytically calculate the rate of growth for various values of T.

\autoref{fig:task2-1-t-dt} shows the rate of growth ($\frac{dN}{dt}$) and the rate of change of the rate of growth ($\frac{d^2N}{dt^2}$) for the simulation, solved analytically.
When we reach a value of $t = 1200$, the rate of growth is 4.083e+08, and the rate of change of the rate of growth is -0.005959.

\clearpage

\subsection{Changing the Capacity}

Changing the capacity value M for the differential equation will change the rate of growth proportionally.
\autoref{fig:task2-1-m} displays that at 1200 time units, the percentage of cells filled is 99.31\% across all values of M.

\begin{figure}[ht]
    \centering
    \includegraphics[width=14cm]{task2-1-m}
    \caption[Cell growth simulation with different capacity values]{Cell growth simulation with different capacity values}
    \label{fig:task2-1-m}
\end{figure}

The different values for M should not change the time to execute the simulation, as the resolution and time steps are the same.

% \[ \frac{dN}{dt}  = kNln\left(\frac{M}{n} \right) \]

% Increasing the value of M will increase the rate of growth.

% Different percentage of cells at the final time for different values of M.

% \begin{center}
% \begin{tabular}{c | c c} 
%     M & Cells & Percentage \\
%     \hline
%     9 & 1e+09 & 100.00\% \\
%     10 & 9.983e+09 & 99.83\% \\
%     11 & 9.966e+10 & 99.66\% \\
%     12 & 9.949e+11 & 99.49\% \\
%     13 & 9.931e+12 & 99.31\% \\
%     14 & 9.914e+13 & 99.14\% \\
%     15 & 9.897e+14 & 98.97\% \\
%     16 & 9.88e+15 & 98.80\% \\
%     17 & 9.863e+16 & 98.63\% \\
% \end{tabular}
% \end{center}

\subsection{Accuracy of the Simulation}

% other differentiation methods...

When using the Euler method, the time step size ($h$ or $\Delta t$) is important for the accuracy of the simulation.
Larger values of $h$ will result in larger computation errors relative to the analytical solution.
\autoref{fig:task2-1-h} and \autoref{fig:task2-1-h-zoom} show the growth  simulation with different values of $h$.

\begin{figure}[ht]
    \centering
    \includegraphics[width=14cm]{task2-1-h}
    \caption[Cell growth simulation with different dt values]{Cell growth simulation with different dt values}
    \label{fig:task2-1-h}
\end{figure}

\clearpage

\begin{figure}[ht]
    \centering
    \includegraphics[width=14cm]{task2-1-h-zoom}
    \caption[Cell growth simulation with different dt values (zoomed)]{Cell growth simulation with different dt values (zoomed)}
    \label{fig:task2-1-h-zoom}
\end{figure}

The mean absolute percentage error for different values of $h$ relative to the analytical solution allows us to determine the optimal value of $h$ for the simulation.
Smaller values of $h$ result in a more accurate simulation.
However, smaller values of $h$ also result in a longer computation time.


\begin{table}[ht]
    \centering
    \begin{tabular}{c | c} 
        h & Error \\
        \hline
        100 & 66.69\% \\
        10 & 5.296\% \\
        1 & 0.5238\% \\
        0.1 & 0.05233\% \\
        0.01 & 0.005233\% \\
        0.001 & 0.0005239\% \\
        0.0001 & 5.82e-05\% \\
        Analytical & 0.0 \\
    \end{tabular}
    \caption[Cell growth simulation error]{Cell growth simulation error}
\end{table}


\clearpage

\subsection{Model Complexity}

While the model is of $\bigO(n)$ complexity, the value for $n$ is inversely proportional to the value of $h$ ($N = 1/h \times t$).
Decreasing $h$ by a factor of 10 will increase the computation time by a factor of 10, this is a reciprocal relationship.

% So in terms of h and t, the relationship is linear.

\begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth, clip, trim=4cm 6cm 1cm 8cm]{growth-dt-criterion}
    \caption[Cell growth criterion]{Cell growth criterion}
    \label{fig:growth-dt-criterion}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth, clip, trim=1cm 0.1cm 5cm 2.2cm]{growth-dt-criterion-lines}
    \caption[Cell growth criterion]{Cell growth criterion}
    \label{fig:growth-dt-criterion-lines}
\end{figure}

Plotting both the value for $h$ and $t$ with logarithmic scales, we can see the relationship between the two values.
It appears that the relationship is linear.

\clearpage

\subsection{Random Walk}

Now we can take the random walk and apply it to the cell growth model to simulate the movement of cells within a tissue.
Before movement, the cells grow to a maximum capacity or a steady state. Once full, the cell moves in a random direction.
Given the random walk is independent of the growth model, we can expect the same results as the independent random walk, displayed in \autoref{fig:task2-2}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=5cm]{task2-2}
    \caption[Cell growth simulation with diagonal movement]{Cell growth simulation with diagonal movement}
    \label{fig:task2-2}
\end{figure}

When the random walk reaches a cell it has already visited, it will instantly move to a new cell as the percentage full will be already above the threshold.
Hence if the total number cells is plotted, we can expect a linear growth as shown in \autoref{fig:task2-2-total} with 100 walk steps.
This linear growth can be estimated with a linear function, the growth is always at a steady state, until the tissue/grid is full.

% \begin{figure}[ht]
%     \centering
%     \includegraphics[width=14cm]{task2-2-total}
%     \caption[Cell growth simulation with diagonal movement (total cells)]{Cell growth simulation with diagonal movement (total cells)}
%     \label{fig:task2-2-total}
% \end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=14cm]{task2-2-total-linear}
    \caption[Cell growth simulation with diagonal movement (total cells) linear estimation]{Cell growth simulation with diagonal movement (total cells) linear estimation}
    \label{fig:task2-2-total-linear}
\end{figure}

\clearpage

\subsection{Changing the Grid Size}

All simulations to this point used a grid size of 100x100, with a maximum capacity of 10,000 cells areas.
\autoref{fig:task1-compare-grid} shows the simulations steps required to fill the grid for different grid sizes,
the graph is plotted against grid area.

\begin{figure}[ht]
    \centering
    \includegraphics[width=14cm]{task1-compare-grid}
    \caption[Cell growth grid comparison]{Cell growth grid comparison}
    \label{fig:task1-compare-grid}
\end{figure}

The relationship between the grid area and the number of steps required to fill the grid is polynomial.
The growth model and random walk remain complexity of $\bigO(n)$, however the grid size is now a factor in the complexity.
This added complexity is related to the concept of filling the grid and is of $\bigO(n^2)$ if $n$ is the grid area.